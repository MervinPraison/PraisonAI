[pytest]
asyncio_mode = auto
asyncio_default_fixture_loop_scope = function
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*
addopts = -v --tb=short --timeout=60
timeout_method = thread
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning

markers =
    # Test type markers (mutually exclusive)
    unit: Pure unit tests - no network, no side effects
    integration: Local integration tests - may use filesystem/db
    e2e: End-to-end tests - external calls allowed if gated
    
    # Provider markers (additive - auto-applied by conftest)
    provider_openai: Requires OpenAI API key (OPENAI_API_KEY)
    provider_anthropic: Requires Anthropic API key (ANTHROPIC_API_KEY)
    provider_google: Requires Google/Gemini API key (GOOGLE_API_KEY)
    provider_ollama: Requires Ollama running locally
    provider_grok_xai: Requires xAI/Grok API key (XAI_API_KEY)
    provider_groq: Requires Groq API key (GROQ_API_KEY)
    provider_cohere: Requires Cohere API key (COHERE_API_KEY)
    
    # Infrastructure markers
    network: Makes outbound network calls
    local_service: Requires Docker or local service running
    slow: Takes more than 5 seconds consistently
    flaky: Known intermittent failures - retries allowed
    allow_sleep: Opt out of fast_sleep fixture
    live: Live tests requiring real API calls
    
    # Legacy markers (kept for backward compatibility)
    asyncio: Async test support
    real: Alias for network + provider tests (legacy)
