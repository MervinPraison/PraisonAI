# Advanced Workflow Example
# Demonstrates: conditional routing, decision tasks, and multi-agent coordination

name: Content Creation Pipeline
description: A workflow that researches, writes, reviews, and publishes content

workflow:
  process: workflow  # Use workflow process for conditional execution
  verbose: true

agents:
  researcher:
    name: Researcher
    role: Research Specialist
    goal: Gather comprehensive information on topics
    backstory: Expert at finding and synthesizing information from various sources
    instructions: |
      Research the given topic thoroughly.
      Provide detailed findings with key points.
    llm: gpt-4o-mini

  writer:
    name: Writer
    role: Content Writer
    goal: Create engaging and informative content
    backstory: Skilled writer who transforms research into readable content
    instructions: |
      Write clear, engaging content based on the research.
      Structure the content with introduction, body, and conclusion.
    llm: gpt-4o-mini

  reviewer:
    name: Reviewer
    role: Quality Reviewer
    goal: Ensure content meets quality standards
    backstory: Meticulous editor who ensures accuracy and clarity
    instructions: |
      Review the content for accuracy, clarity, and engagement.
      Decide if it's ready for publication or needs revision.
    llm: gpt-4o-mini

  publisher:
    name: Publisher
    role: Content Publisher
    goal: Finalize and format content for publication
    backstory: Expert at preparing content for various platforms
    instructions: |
      Format the approved content for publication.
      Add metadata and prepare final deliverable.
    llm: gpt-4o-mini

steps:
  # Step 1: Research (starting point)
  - name: research_task
    agent: researcher
    action: "Research the topic: AI trends in 2025"
    expected_output: "Comprehensive research findings with key points and sources"
    is_start: true
    next_tasks: [write_task]

  # Step 2: Write content based on research
  - name: write_task
    agent: writer
    action: "Write an article based on the research findings"
    expected_output: "Well-structured article with introduction, body, and conclusion"
    context: [research_task]
    next_tasks: [review_task]

  # Step 3: Review with decision (conditional routing)
  - name: review_task
    agent: reviewer
    action: "Review the article for quality and accuracy"
    expected_output: "Quality assessment with approval or revision recommendation"
    context: [write_task]
    task_type: decision
    condition:
      approved: [publish_task]
      needs_revision: [revise_task]

  # Step 4a: Revision (conditional - only if review fails)
  - name: revise_task
    agent: writer
    action: "Revise the article based on reviewer feedback"
    expected_output: "Revised article addressing all feedback"
    context: [write_task, review_task]
    next_tasks: [review_task]  # Loop back to review

  # Step 4b: Publish (conditional - only if review passes)
  - name: publish_task
    agent: publisher
    action: "Prepare the approved article for publication"
    expected_output: "Final formatted article ready for publication"
    context: [write_task, review_task]
